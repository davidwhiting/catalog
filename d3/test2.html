<!DOCTYPE html>
<html>
<head>

  <style>
    body {
      text-align: center;
    }
    
    svg {
      margin-top: 32px;
      border: 1px solid #aaa;
    }
  </style>

  <!-- Load d3.js -->
  <script src='https://d3js.org/d3.v4.js'></script>
  
  <!-- For slider -->
  <script src="https://unpkg.com/d3-simple-slider"></script>
</head>

<body>

  <script type="module">
    // Your D3 script here
    //import { data } from "./data.js";
    //console.log(data);
    
    let original_data = [  
      { seq:  1, name: 'PACE 111B', credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  2, name: 'LIBS 150',  credits: 1, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  3, name: 'WRTG 111',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  4, name: 'WRTG 112',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  5, name: 'NUTR 100',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  6, name: 'BMGT 110',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq:  7, name: 'SPCH 100',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  8, name: 'STAT 200',  credits: 3, color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq:  9, name: 'IFSM 300',  credits: 3, color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 10, name: 'ACCT 220',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 11, name: 'HUMN 100',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 12, name: 'BIOL 103',  credits: 4, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 13, name: 'ECON 201',  credits: 3, color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 14, name: 'ARTH 334',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 15, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 16, name: 'ECON 203',  credits: 3, color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 17, name: 'ACCT 221',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: 'ACCT 220' },  
      { seq: 18, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 19, name: 'BMGT 364',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 20, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 21, name: 'BMGT 365',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: 'BMGT 364' },
      { seq: 22, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 23, name: 'MRKT 310',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 24, name: 'WRTG 394',  credits: 3, color: 'green',  textcolor: 'white', prerequisite: 'WRTG 112' },
      { seq: 25, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 26, name: 'BMGT 380',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 27, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 28, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 29, name: 'HRMN 300',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 30, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 31, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 32, name: 'FINC 330',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: 'ACCT 221 & STAT 200' },  
      { seq: 33, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 34, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 35, name: 'BMGT 496',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 36, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 37, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 38, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 39, name: 'ELECTIVE',  credits: 3, color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 40, name: 'BMGT 495',  credits: 3, color: 'blue',   textcolor: 'white', prerequisite: 'BMGT 365 & MRKT 310 & FINC 330' },
      { seq: 41, name: 'CAPSTONE',  credits: 1, color: 'yellow', textcolor: 'black', prerequisite: 'FINC 330' }
    ];

    let original_data_new = [  
      { seq:  1, name: 'PACE 111B', credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  2, name: 'LIBS 150',  credits: 1, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  3, name: 'WRTG 111',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  4, name: 'WRTG 112',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  5, name: 'NUTR 100',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  6, name: 'BMGT 110',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq:  7, name: 'SPCH 100',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  8, name: 'STAT 200',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq:  9, name: 'IFSM 300',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 10, name: 'ACCT 220',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 11, name: 'HUMN 100',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 12, name: 'BIOL 103',  credits: 4, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 13, name: 'ECON 201',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 14, name: 'ARTH 334',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 15, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 16, name: 'ECON 203',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 17, name: 'ACCT 221',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'ACCT 220' },  
      { seq: 18, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 19, name: 'BMGT 364',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 20, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 21, name: 'BMGT 365',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'BMGT 364' },
      { seq: 22, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 23, name: 'MRKT 310',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 24, name: 'WRTG 394',  credits: 3, complete: 'false', type: 'general',  prerequisite: 'WRTG 112' },
      { seq: 25, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 26, name: 'BMGT 380',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 27, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 28, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 29, name: 'HRMN 300',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 30, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 31, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 32, name: 'FINC 330',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'ACCT 221 & STAT 200' },  
      { seq: 33, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 34, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 35, name: 'BMGT 496',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 36, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 37, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 38, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 39, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 40, name: 'BMGT 495',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'BMGT 365 & MRKT 310 & FINC 330' },
      { seq: 41, name: 'CAPSTONE',  credits: 1, complete: 'false', type: 'elective', prerequisite: 'FINC 330' }
    ];
    
    let transfer_data = [  
      { seq:  1, name: 'PACE 111B', credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  2, name: 'LIBS 150',  credits: 1, complete: 'true',  color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  3, name: 'WRTG 111',  credits: 3, complete: 'true',  color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  4, name: 'WRTG 112',  credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  5, name: 'NUTR 100',  credits: 3, complete: 'trans', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  6, name: 'BMGT 110',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq:  7, name: 'SPCH 100',  credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq:  8, name: 'STAT 200',  credits: 3, complete: 'true',  color: 'black',  textcolor: 'white', prerequisite: '' },
      { seq:  9, name: 'IFSM 300',  credits: 3, complete: 'false', color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 10, name: 'ACCT 220',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 11, name: 'HUMN 100',  credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 12, name: 'BIOL 103',  credits: 4, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 13, name: 'ECON 201',  credits: 3, complete: 'false', color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 14, name: 'ARTH 334',  credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: '' },
      { seq: 15, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 16, name: 'ECON 203',  credits: 3, complete: 'false', color: 'red',    textcolor: 'white', prerequisite: '' },
      { seq: 17, name: 'ACCT 221',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: 'ACCT 220' },  
      { seq: 18, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 19, name: 'BMGT 364',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 20, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 21, name: 'BMGT 365',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: 'BMGT 364' },
      { seq: 22, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 23, name: 'MRKT 310',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 24, name: 'WRTG 394',  credits: 3, complete: 'false', color: 'green',  textcolor: 'white', prerequisite: 'WRTG 112' },
      { seq: 25, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 26, name: 'BMGT 380',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 27, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 28, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 29, name: 'HRMN 300',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 30, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 31, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 32, name: 'FINC 330',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: 'ACCT 221 & STAT 200' },  
      { seq: 33, name: 'ELECTIVE',  credits: 3, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 34, name: 'TRANSFER',  credits: 3, complete: 'trans', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 35, name: 'BMGT 496',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: '' },
      { seq: 36, name: 'ELECTIVE',  credits: 3, complete: 'trans', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 37, name: 'ELECTIVE',  credits: 3, complete: 'trans', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 38, name: 'ELECTIVE',  credits: 3, complete: 'trans', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 39, name: 'ELECTIVE',  credits: 3, complete: 'trans', color: 'yellow', textcolor: 'black', prerequisite: '' },
      { seq: 40, name: 'BMGT 495',  credits: 3, complete: 'false', color: 'blue',   textcolor: 'white', prerequisite: 'BMGT 365 & MRKT 310 & FINC 330' },
      { seq: 41, name: 'CAPSTONE',  credits: 1, complete: 'false', color: 'yellow', textcolor: 'black', prerequisite: 'FINC 330 & BMGT 496' }
    ];

    let transfer_data_new = [  
      { seq:  1, name: 'PACE 111B', credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  2, name: 'LIBS 150',  credits: 1, complete: 'true',  type: 'general',  prerequisite: '' },
      { seq:  3, name: 'WRTG 111',  credits: 3, complete: 'true',  type: 'general',  prerequisite: '' },
      { seq:  4, name: 'WRTG 112',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  5, name: 'NUTR 100',  credits: 3, complete: 'trans', type: 'general',  prerequisite: '' },
      { seq:  6, name: 'BMGT 110',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq:  7, name: 'SPCH 100',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq:  8, name: 'STAT 200',  credits: 3, complete: 'true',  type: 'required', prerequisite: '' },
      { seq:  9, name: 'IFSM 300',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 10, name: 'ACCT 220',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 11, name: 'HUMN 100',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 12, name: 'BIOL 103',  credits: 4, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 13, name: 'ECON 201',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 14, name: 'ARTH 334',  credits: 3, complete: 'false', type: 'general',  prerequisite: '' },
      { seq: 15, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 16, name: 'ECON 203',  credits: 3, complete: 'false', type: 'required', prerequisite: '' },
      { seq: 17, name: 'ACCT 221',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'ACCT 220' },  
      { seq: 18, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 19, name: 'BMGT 364',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 20, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 21, name: 'BMGT 365',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'BMGT 364' },
      { seq: 22, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 23, name: 'MRKT 310',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 24, name: 'WRTG 394',  credits: 3, complete: 'false', type: 'general',  prerequisite: 'WRTG 112' },
      { seq: 25, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 26, name: 'BMGT 380',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 27, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 28, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 29, name: 'HRMN 300',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 30, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 31, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 32, name: 'FINC 330',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'ACCT 221 & STAT 200' },  
      { seq: 33, name: 'ELECTIVE',  credits: 3, complete: 'false', type: 'elective', prerequisite: '' },
      { seq: 34, name: 'TRANSFER',  credits: 3, complete: 'trans', type: 'elective', prerequisite: '' },
      { seq: 35, name: 'BMGT 496',  credits: 3, complete: 'false', type: 'major',    prerequisite: '' },
      { seq: 36, name: 'ELECTIVE',  credits: 3, complete: 'trans', type: 'elective', prerequisite: '' },
      { seq: 37, name: 'ELECTIVE',  credits: 3, complete: 'trans', type: 'elective', prerequisite: '' },
      { seq: 38, name: 'ELECTIVE',  credits: 3, complete: 'trans', type: 'elective', prerequisite: '' },
      { seq: 39, name: 'ELECTIVE',  credits: 3, complete: 'trans', type: 'elective', prerequisite: '' },
      { seq: 40, name: 'BMGT 495',  credits: 3, complete: 'false', type: 'major',    prerequisite: 'BMGT 365 & MRKT 310 & FINC 330' },
      { seq: 41, name: 'CAPSTONE',  credits: 1, complete: 'false', type: 'elective', prerequisite: 'FINC 330 & BMGT 496' }
    ];

    let data = original_data;
//    let data = transfer_data;

    var transferCredits = false;

    // Dropdown Menu Stuff
    // Select Degree
    var chosenDegree = "SE";
    var degreeList = [
      [0, "SE", "SELECT DEGREE"],
      [1, "AS", "Associate"],
      [2, "BS", "Bachelor's"],
      [3, "MS", "Master's"],
      [4, "DC", "Doctorate"],
      [5, "UC", "Undergraduate Certificate"],
      [6, "GC", "Graduate Certificate"]
    ];
    
    // Select Area of Study
    var chosenStudy = "SE";
    var studyList = [
      [0, "SE", "SELECT AREA OF STUDY"],
      [1, 'BM', 'Business & Management'],
      [2, 'CS', 'Cybersecurity'],
      [3, 'DA', 'Data Analytics'],
      [4, 'ET', 'Education & Teaching'],
      [5, 'HS', 'Healthcare & Science'],
      [6, 'LA', 'Liberal Arts & Communications'],
      [7, 'PS', 'Public Safety'],
      [8, 'IT', 'IT & Computer Science']
    ];
    
    // Select Major
    var chosenMajor = "SE";
    var majorList = [
      [0, "SE", "SELECT MAJOR"],
      [1, 'AC', 'Accounting'],
      [2, 'BA', 'Business Administration'],
      [3, 'FI', 'Finance'],
      [4, 'HR', 'Human Resource Management'],
      [5, 'MS', 'Management Studies'],
      [6, 'MK', 'Marketing']
    ];

    // Legend color stuff

    // Define the colors and labels for the legend
    var legendData = [
      { label: "Major", color: "blue", textcolor: "white" },
      { label: "Required", color: "red", textcolor: "white" },
      { label: "General", color: "green", textcolor: "white" },
      { label: "Elective", color: "yellow", textcolor: "black" },
      { label: "Transfer", color: "gray", textcolor: "black" },
      { label: "Completed", color: "black", textcolor: "white" }
    ];

    var screen_width = 800;
    var box_width = 110;
    var box_height = 40;
    var text_x_offset = 10; 
    var text_y_offset = 25;

    function drawRectangleNew(x, y, name, color, textcolor, description='') {
      var g = zoomable.append("g");
      
      g.append("rect")
        .attr("x", x)
        .attr("y", y)
        .attr("width", box_width)
        .attr("height", box_height)
        .style("fill", color)
        .classed("movable", true); // Add the "movable" class
      
      g.append("text")
        .attr("x", x + text_x_offset)
        .attr("y", y + text_y_offset)
        .text(name)
        .attr("fill", textcolor)
        .style("font-size", "12px")
        .style("font-family", "Arial")
        .style("font-weight", "bold")
        .classed("movable", true); // Add the "movable" class
    
      // Add a tooltip
      g.append("description")
        .text(description);
    }
    
    function drawColumn(period, data) {
      let filteredData = data.filter(item => item.period === period);
      for (let j = 0; j < data.length; j++) {
        let item = filteredData[j];
        if (item !== undefined) {
          let fullname = `${item.name} (${item.credits})`;
          drawRectangleNew(bin[period], row[j], fullname, item.color, item.textcolor);
        }
      }
    }
    
    function drawSchedule(data) {
      // find max 
      var max_period = Math.max(...data.map(item => item.period));
      for (let j = 0; j <= max_period; j++) {
        drawColumn(j, data);
      }
    }
    
    function assignBins(max_credits, data) {
      // Initialize an array to keep track of the total credits in each bin
      let binCredits = [0];
    
      // Initialize an object to keep track of the bin of each course
      let courseBin = {};
    
      for (let j = 0; j < data.length; j++) {
        let item = data[j];
    
        // If the course is complete, assign it to bin 0 and continue to the next course
        if (item.complete === 'true') {
          courseBin[item.name] = 0;
          item.period = 0;
          item.color = 'black';
          item.textcolor = 'white';
        } else if (item.complete === 'trans') {
          courseBin[item.name] = 0;
          item.period = 0;
          item.color = 'gray';
          item.textcolor = 'black';  
        } else {
    
          // Assign bins with prerequisites
          let startBin = 1;
      
          // if prerequisite line non-empty
          if (item.prerequisite) {
            // Split the prerequisites string into an array of prerequisites
            let prerequisites = item.prerequisite.split(' & ');
      
            // Get the bin of each prerequisite
            let prerequisiteBins = prerequisites.map(prerequisite => courseBin[prerequisite]);
      
            // Find the maximum bin among the prerequisites
            let maxPrerequisiteBin = Math.max(...prerequisiteBins);
      
            // Assign the minimum bin
            startBin = maxPrerequisiteBin + 1; 
          }   
          let period = startBin;
      
          let done = 0;
          while (done === 0) {
            if (binCredits[period] === undefined) {
              binCredits[period] = item.credits;
              done = 1;
            } else if (binCredits[period] + item.credits > max_credits) {
              period++;
            } else {
              binCredits[period] += item.credits;
              done = 1;
            }
          } 
          courseBin[item.name] = period;
          item.period = period;
        }
      }
    }

    function creditSummary(data) {
      // create sum of credits per period
    
      let summary = data.reduce((acc, item) => {
        // If the period doesn't exist in the accumulator, add it
        if (!acc[item.period]) {
          acc[item.period] = { totalCredits: 0, courseCount: 0 };
        }
      
        // Add the credits for the current item to the period
        acc[item.period].totalCredits += item.credits;
      
        // Increment the course count for the period
        acc[item.period].courseCount++;
      
        return acc;
      }, {});
    
      return summary;
    }
    
    // Define x coordinates for rectangles
    var sessionOffset = 3;
    var bin = [10];
    for (let k=0; k <=30; k++) {
        bin.push(bin[k] + 20 + box_width);
    }
    
    // Define y coordinates for rectangles
    var y_gap = 4;
    var box_space = box_height + y_gap;
    var row = [50];
    for (let k=0; k <=10; k++) {
        row.push(row[k] + box_space);
    }
    
    // quick hack for demo
    // this is not the real way I want to do it!
    function redraw(maxc, data, odata=original_data, tdata=transfer_data) {
      assignBins(maxc, odata);
      assignBins(maxc, tdata);
       zoomable.selectAll(".movable").remove();
      if (transferCredits) {
        drawSchedule(tdata);
      } else {
        drawSchedule(odata);
      }
    }

    function redraw_old(maxc, data) {
      assignBins(maxc, data);
      zoomable.selectAll(".movable").remove();
      drawSchedule(data);
    }

    function clearAll() {
       zoomable.selectAll(".movable").remove();
    }

    // end D3 script insertion

    // Select the body
    var body = d3.select("body");

    // Append a new h1 to the body
    var h1 = body.append("h1");

    // Set the text of the h1
    h1.text("Student Curriculum Explorer");

    // DROPDOWN MENUS

    // Create a container for the dropdowns
    var container = body.append("div")
      .style("display", "flex")
      .style("justify-content", "space-between")
      .style("align-items", "center") // Vertically center the menus
      .style("gap", "1px") // Add a space of 2px between the menus
      .style("width", "800px") // Specify the width of the container
      .style("margin", "0 auto"); // Center the container

    // Degree dropdown
    var degreeDropdown = container.append("div");
    var degreeSelect = degreeDropdown.append("select")
      .attr('id', 'degreeDropDownId');
    var degreeOptions = degreeSelect.selectAll('option')
      .data(degreeList)
      .enter()
      .append('option')
      .attr('value', (d) => d[1])
      .text((d) => d[2]);
    degreeOptions.property("selected", function(d) {
      return d[1] === chosenDegree;
    });
    
    // Area of Study dropdown
    var studyDropdown = container.append("div");
    var studySelect = studyDropdown.append("select")
      .attr('id', 'studyDropDownId');
    var studyOptions = studySelect.selectAll('option')
      .data(studyList)
      .enter()
      .append('option')
      .attr('value', (d) => d[1])
      .text((d) => d[2]);
    studyOptions.property("selected", function(d) {
      return d[1] === chosenStudy;
    });
    
    // Major dropdown
    var majorDropdown = container.append("div");
    var majorSelect = majorDropdown.append("select")
      .attr('id', 'majorDropDownId');
    var majorOptions = majorSelect.selectAll('option')
      .data(majorList)
      .enter()
      .append('option')
      .attr('value', (d) => d[1])
      .text((d) => d[2]);
    majorOptions.property("selected", function(d) {
      return d[1] === chosenMajor;
    });

    // Add an event listener to the Major dropdown

    majorSelect.on("change", function() {
      // Get the current value of the dropdown
      var selectedMajor = d3.select(this).property("value");
    
      // If the selected major is "BA", run redraw(12, data)
      if (selectedMajor === "BA") {
        redraw(12, data);
      }
      // If the selected major is not "BA", run clearAll()
      else {
        clearAll();
      }
    });
    
    // END DROPDOWN MENUS

    // Append the SVG to the body after the dropdowns
    var svg = body.append('svg')
      .attr('id', 'dataviz_area')
      .attr('height', 400)
      .attr('width', 800);

    // Define the zoomable group
    var zoomable = svg.append("g");
    
    // Define the zoom behavior
    var zoom = d3.zoom()
      .on("zoom", function() {
        zoomable.attr("transform", d3.event.transform);
      });
    
    // Apply the zoom behavior to your SVG
    svg.call(zoom);
        
    // set up default
    //redraw(12, data);
    
    // let summary = creditSummary(data);
    
    //console.log(summary.length);
    console.log(data);

body.append("h3")
  .text("Select Credit Hours per Term:");

    // Slider
    var slider = d3
      .sliderBottom()
      .min(6)
      .max(18)
      .step(1)
      .width(700)
      .default(12)
      .on('onchange', val => {
        redraw(val, data);
      });

    // Append the slider to the body
    var sliderDiv = body.append("div")
      .attr("id", "slider");
       
    var gSlider = sliderDiv
      .append('svg')
      .attr('width', 700)
      .attr('height', 100)
      .append('g')
      .attr('transform', 'translate(30,30)');
    
    gSlider.call(slider);

////    // Append the checkbox to the body
////    var checkboxDiv = body.append("div");
////    
////    checkboxDiv.append("input")
////      .attr("type", "checkbox")
////      .attr("id", "toggleHighlight")
////      .attr("name", "toggleHighlight");
////    
////    checkboxDiv.append("label")
////      .attr("for", "toggleHighlight")
////      .text("Prerequisites");
////
//    // Transfer Credits
//    var transferCheckboxDiv = body.append("div");
//    
//    var transferCheckbox = transferCheckboxDiv.append("input")
//      .attr("type", "checkbox")
//      .attr("id", "toggleTransfer")
//      .attr("name", "toggleTransfer");
//    
//    transferCheckboxDiv.append("label")
//      .attr("for", "toggleTransfer")
//      .text("Transfer Credits");
//
//    // Add an event listener to the checkbox
//    transferCheckbox.on("change", function() {
//      // Get the current state of the checkbox
//      var isCheckedTransfer = d3.select(this).property("checked");
//      console.log(isCheckedTransfer);
//    
//      // If the checkbox is checked, 
//      if (isCheckedTransfer) {
//        transferCredits = true;
//        data = transfer_data;
//      }
//      // If the checkbox is not checked, set data to old
//      else {
//        transferCredits = false;
//        data = original_data;
//      }
//    });

body.append("h3")
  .text("Transfer Credits:");

      // Append the checkbox to the body
      var checkboxDiv = body.append("div");
      
      var checkbox = checkboxDiv.append("input")
        .attr("type", "checkbox")
        .attr("id", "toggleHighlight")
        .attr("name", "toggleHighlight");
      
      checkboxDiv.append("label")
        .attr("for", "toggleHighlight")
        .text("Import Transfer Credits");
      
      // Add an event listener to the checkbox
      checkbox.on("change", function() {
        // Get the current state of the checkbox
        var isChecked = d3.select(this).property("checked");
      
        // If the checkbox is checked, run runPrerequisites(data, clicked=true)
        if (isChecked) {
          transferCredits = true;
          data = transfer_data;
          redraw(12, data);
        }
        // If the checkbox is not checked, set data to old
        else {
          transferCredits = false;
          data = original_data;
          redraw(12, data);
        }
      });


//      // Append the checkbox to the body
//      var checkboxDiv = body.append("div");
//      
//      var checkbox = checkboxDiv.append("input")
//        .attr("type", "checkbox")
//        .attr("id", "toggleHighlight")
//        .attr("name", "toggleHighlight");
//      
//      checkboxDiv.append("label")
//        .attr("for", "toggleHighlight")
//        .text("Transfer Credits");
//      
//      // Add an event listener to the checkbox
//      checkbox.on("change", function() {
//        // Get the current state of the checkbox
//        var isChecked = d3.select(this).property("checked");
//      
//        // If the checkbox is checked, run runPrerequisites(data, clicked=true)
//        if (isChecked) {
//          transferCredits = true;
//          data = transfer_data;
//          redraw(12, data);
//        }
//        // If the checkbox is not checked, set data to old
//        else {
//          transferCredits = false;
//          data = original_data;
//          redraw(12, data);
//        }
//      });

// Append a title to the container
body.append("h3")
  .text("Personalized Recommendations:");

// Define your options
var options = ["Department Recommendation", "(AI) Students like me", "(AI) Quickest to completion"];

// Create a container for the form
var container = body.append("div")
  .style("width", "30%") // Set the width of the container
  .style("margin", "0 auto") // Center the container
  .style("border", "1px solid black"); // Add a black border

// Create a form with left-aligned text in the container
var form = container.append("form")
  .style("text-align", "left");

// Your code for creating the radio buttons here

// Create a div for each option
var optionDivs = form.selectAll("div")
  .data(options)
  .enter()
  .append("div");

// Append a radio button to each div
optionDivs.append("input")
  .attr("type", "radio")
  .attr("name", "options")
  .attr("value", function(d) { return d; })
  .property("checked", function(d, i) { return i === 0; }); // The first radio button is checked

// Append a label to each div
optionDivs.append("label")
  .text(function(d) { return d; });

// Append a title to the container
body.append("h3")
  .text("Explore Electives");

// Define your options
var options = ["No Prerequisites", "(AI) Explore Minors", "(AI) Students like me"];

// Create a container for the form
var container = body.append("div")
  .style("width", "30%") // Set the width of the container
  .style("margin", "0 auto") // Center the container
  .style("border", "1px solid black"); // Add a black border

// Create a form with left-aligned text in the container
var form = container.append("form")
  .style("text-align", "left");

// Your code for creating the radio buttons here

// Create a div for each option
var optionDivs = form.selectAll("div")
  .data(options)
  .enter()
  .append("div");

// Append a radio button to each div
optionDivs.append("input")
  .attr("type", "radio")
  .attr("name", "options")
  .attr("value", function(d) { return d; })
  .property("checked", function(d, i) { return i === 0; }); // The first radio button is checked

// Append a label to each div
optionDivs.append("label")
  .text(function(d) { return d; });


    // Your SVG code here
  </script>

</body>
</html>
